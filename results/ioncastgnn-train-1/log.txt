NASA Heliolab 2025 - Ionosphere-Thermosphere Twin, ML experiments
Log file: ./../../results/ioncastgnn-train-1/log.txt
Arguments:
--data_dir /home/jupyter/data --aux_dataset celestrak --mode train --target_dir ./../../results/ioncastgnn-train-1 --num_workers 4 --batch_size 1 --model_type IonCastGNN --epochs 1 --learning_rate 1e-3 --weight_decay 0.0 --context_window 2 --prediction_window 1 --num_evals 1 --date_start 2023-07-01T00:00:00 --date_end 2023-08-01T00:00:00 --device cuda:0 --mesh_level 1
Config:
{'aux_datasets': ['celestrak'],
 'batch_size': 1,
 'celestrak_file': 'celestrak/kp_ap_processed_timeseries.csv',
 'channel_list': None,
 'context_window': 2,
 'data_dir': '/home/jupyter/data',
 'date_end': '2023-08-01T00:00:00',
 'date_start': '2023-07-01T00:00:00',
 'delta_minutes': 15,
 'device': 'cuda:0',
 'epochs': 1,
 'ioncast_hidden_dim': 512,
 'ioncast_hidden_layers': 1,
 'ioncast_processor_layers': 6,
 'jpld_dir': 'jpld/webdataset',
 'learning_rate': 0.001,
 'mesh_level': 1,
 'mode': 'train',
 'model_file': None,
 'model_type': 'IonCastGNN',
 'num_evals': 1,
 'num_workers': 4,
 'omni_dir': 'omniweb/cleaned/',
 'prediction_window': 1,
 'processor_type': 'MessagePassing',
 'seed': 0,
 'solar_index_file': 'solar_env_tech_indices/Indices_F10_processed.csv',
 'target_dir': './../../results/ioncastgnn-train-1',
 'test_event_id': ['G2H9-202406280900'],
 'test_event_seen_id': ['G1H9-202404190600'],
 'weight_decay': 0.0}
Start time: 2025-08-01 23:52:10.587975

*** Training mode

Processing excluded dates
Excluding event ID: G2H9-202406280900

JPLD
Directory  : /home/jupyter/data/jpld/webdataset
Loading tar files index from cache: /home/jupyter/data/jpld/webdataset/tar_files_index
Start date : 2024-06-28 04:30:00
End date   : 2024-06-29 03:00:00
Delta      : 15 minutes
Loading dates from cache: /home/jupyter/data/jpld/webdataset/dates_index_2024-06-28T04:30:00_2024-06-29T03:00:00
TEC maps total    : 90
TEC maps available: 90
TEC maps dropped  : 0

Celestrak dataset
File                 : /home/jupyter/data/celestrak/kp_ap_processed_timeseries.csv
Rows                 : 198,320
Delta minutes        : 15
Normalize            : True
Rewind minutes       : 180
column:['Kp', 'Ap']
2379829
Start date           : 2024-06-28 04:30:00
End date             : 2024-06-29 03:00:00
Rows after processing: 91

Union of datasets
Dataset : JPLD (2024-06-28 04:30:00 - 2024-06-29 03:00:00)

Concatenated datasets
Dataset : Celestrak dataset (2024-06-28 04:30:00 - 2024-06-29 03:00:00)

Start and end dates:  2024-06-28 04:30:00 2024-06-29 03:00:00

JPLD
Directory  : /home/jupyter/data/jpld/webdataset
Loading tar files index from cache: /home/jupyter/data/jpld/webdataset/tar_files_index
Start date : 2023-07-01 00:00:00
End date   : 2023-08-01 00:00:00
Delta      : 15 minutes
Date exclusions:
  2024-06-28 04:30:00 - 2024-06-29 03:00:00
Loading dates from cache: /home/jupyter/data/jpld/webdataset/dates_index_2023-07-01T00:00:00_2023-08-01T00:00:00_exclusions__2024-06-28T04:30:00_2024-06-29T03:00:00
TEC maps total    : 2,976
TEC maps available: 2,976
TEC maps dropped  : 0

Celestrak dataset
File                 : /home/jupyter/data/celestrak/kp_ap_processed_timeseries.csv
Rows                 : 198,320
Delta minutes        : 15
Normalize            : True
Rewind minutes       : 180
column:['Kp', 'Ap']
2379829
Date exclusions:
  2024-06-28 04:30:00 - 2024-06-29 03:00:00
Start date           : 2023-07-01 00:00:00
End date             : 2023-08-01 00:00:00
Rows after processing: 2,977

Sequences
Start date              : 2023-07-01 00:00:00
End date                : 2023-08-01 00:00:00
Delta                   : 15 minutes
Sequence length         : 3
Sequence duration       : 45 minutes
Number of sequences     : 2,975
First sequence          : ['2023-07-01T00:00:00', '2023-07-01T00:15:00', '2023-07-01T00:30:00']
Last sequence           : ['2023-07-31T23:30:00', '2023-07-31T23:45:00', '2023-08-01T00:00:00']

Sequences
Start date              : 2024-06-28 04:30:00
End date                : 2024-06-29 02:45:00
Delta                   : 15 minutes
Sequence length         : 3
Sequence duration       : 45 minutes
Number of sequences     : 88
First sequence          : ['2024-06-28T04:30:00', '2024-06-28T04:45:00', '2024-06-28T05:00:00']
Last sequence           : ['2024-06-29T02:15:00', '2024-06-29T02:30:00', '2024-06-29T02:45:00']

Train size: 2,975
Valid size: 88
Creating new model

Number of parameters: 16,835,075


*** Epoch 1/1 started
*** Training
Traceback (most recent call last):
  File "run.py", line 508, in main
    train_losses.append((iteration, float(loss)))
                                    ^^^^^^^^^^^
KeyboardInterrupt
