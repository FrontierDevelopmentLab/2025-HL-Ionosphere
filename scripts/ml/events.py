import pandas as pd

# SDOML-lite: 2010-05-13T00:00:00 - 2024-07-27T00:00:00

# NOAA Space Weather Scales
# Geomagnetic Storms
# https://www.swpc.noaa.gov/noaa-scales-explanation
#
# G0: Unsettled (Kp < 4)
# G1: Minor (5 <= Kp < 6)
# G2: Moderate (6 <= Kp < 7)
# G3: Strong (7 <= Kp < 8)
# G4: Severe (8 <= Kp < 9)
# G5: Extreme (Kp >= 9)

# The Mestici Scale
# G1H9: G1 and higher geomagnetic storms, with a duration of at least 9 hours
# G2H9: G2 and higher geomagnetic storms, with a duration of at least 9 hours
# G3H9: G3 and higher geomagnetic storms, with a duration of at least 9 hours
# G4H9: G4 and higher geomagnetic storms, with a duration of at least 9 hours
# G5H9: G5 and higher geomagnetic storms, with a duration of at least 9 hours
# The events are based on the Mestici Scale, which is a measure of geomagnetic storm activity.

# Event name prefix; Start Time YYYY-MM-DDTHH:MM:SS; End Time YYYY-MM-DDTHH:MM:SS; max Kp
events = []

# G2H9 events from the CSV data
events.append(('G2H9', '2011-08-05T18:00:00', '2011-08-06T03:00:00', 7.7))
events.append(('G2H9', '2011-10-24T18:00:00', '2011-10-25T06:00:00', 7.3))
events.append(('G2H9', '2012-03-09T00:00:00', '2012-03-09T15:00:00', 8))
events.append(('G2H9', '2013-03-17T06:00:00', '2013-03-17T21:00:00', 6.7))
events.append(('G2H9', '2015-06-22T12:00:00', '2015-06-23T12:00:00', 8.3))
events.append(('G2H9', '2015-09-11T06:00:00', '2015-09-11T15:00:00', 7))
events.append(('G2H9', '2017-09-07T21:00:00', '2017-09-08T21:00:00', 8.3))
events.append(('G2H9', '2017-11-07T18:00:00', '2017-11-08T03:00:00', 6.3))
events.append(('G2H9', '2021-11-03T21:00:00', '2021-11-04T12:00:00', 7.7))
events.append(('G2H9', '2023-03-23T09:00:00', '2023-03-24T06:00:00', 8))
events.append(('G2H9', '2023-04-23T12:00:00', '2023-04-24T09:00:00', 8.3))
events.append(('G2H9', '2023-11-05T09:00:00', '2023-11-05T21:00:00', 7.3))
events.append(('G2H9', '2024-05-10T15:00:00', '2024-05-12T03:00:00', 9))
events.append(('G2H9', '2024-06-28T09:00:00', '2024-06-28T18:00:00', 7.7))
# events.append(('G2H9', '2024-08-11T21:00:00', '2024-08-13T00:00:00', 8))
# events.append(('G2H9', '2024-10-10T15:00:00', '2024-10-11T12:00:00', 8.7))
# events.append(('G2H9', '2025-01-01T03:00:00', '2025-01-01T18:00:00', 8))
# events.append(('G2H9', '2025-04-16T09:00:00', '2025-04-16T21:00:00', 7.7))
# events.append(('G2H9', '2025-06-01T00:00:00', '2025-06-01T18:00:00', 7.7))

# G1H9 events from the CSV data
events.append(('G1H9', '2010-04-05T06:00:00', '2010-04-05T15:00:00', 7.7))
events.append(('G1H9', '2010-05-02T12:00:00', '2010-05-03T00:00:00', 6.0))
events.append(('G1H9', '2011-09-09T12:00:00', '2011-09-10T03:00:00', 5.7))
events.append(('G1H9', '2011-09-26T12:00:00', '2011-09-27T03:00:00', 6.3))
events.append(('G1H9', '2012-03-07T03:00:00', '2012-03-07T18:00:00', 6.0))
events.append(('G1H9', '2012-03-15T12:00:00', '2012-03-15T21:00:00', 6.3))
events.append(('G1H9', '2012-04-23T18:00:00', '2012-04-24T06:00:00', 6.7))
events.append(('G1H9', '2012-07-15T03:00:00', '2012-07-16T06:00:00', 7.0))
events.append(('G1H9', '2012-10-13T03:00:00', '2012-10-13T15:00:00', 5.7))
events.append(('G1H9', '2013-06-01T00:00:00', '2013-06-01T12:00:00', 7.0))
events.append(('G1H9', '2013-06-06T21:00:00', '2013-06-07T06:00:00', 5.7))
events.append(('G1H9', '2013-06-28T21:00:00', '2013-06-29T12:00:00', 6.3))
events.append(('G1H9', '2013-10-08T18:00:00', '2013-10-09T06:00:00', 5.7))
events.append(('G1H9', '2014-02-19T03:00:00', '2014-02-19T12:00:00', 6.3))
events.append(('G1H9', '2014-02-20T03:00:00', '2014-02-20T12:00:00', 6.0))
events.append(('G1H9', '2014-06-08T03:00:00', '2014-06-08T12:00:00', 6.3))
events.append(('G1H9', '2015-03-18T12:00:00', '2015-03-18T21:00:00', 5.3))
events.append(('G1H9', '2015-04-16T18:00:00', '2015-04-17T03:00:00', 6.0))
events.append(('G1H9', '2015-05-13T00:00:00', '2015-05-13T09:00:00', 5.7))
events.append(('G1H9', '2015-07-04T18:00:00', '2015-07-05T03:00:00', 5.3))
events.append(('G1H9', '2015-08-26T15:00:00', '2015-08-27T06:00:00', 6.3))
events.append(('G1H9', '2015-09-07T12:00:00', '2015-09-08T03:00:00', 6.3))
events.append(('G1H9', '2015-09-09T03:00:00', '2015-09-09T21:00:00', 6.0))
events.append(('G1H9', '2015-10-07T03:00:00', '2015-10-08T06:00:00', 7.3))
events.append(('G1H9', '2015-11-07T00:00:00', '2015-11-07T09:00:00', 6.0))
events.append(('G1H9', '2015-12-31T18:00:00', '2016-01-01T06:00:00', 6.0))
events.append(('G1H9', '2016-02-16T09:00:00', '2016-02-17T00:00:00', 5.3))
events.append(('G1H9', '2016-05-08T00:00:00', '2016-05-09T00:00:00', 6.3))
events.append(('G1H9', '2016-06-05T12:00:00', '2016-06-05T21:00:00', 5.3))
events.append(('G1H9', '2016-09-01T18:00:00', '2016-09-02T03:00:00', 6.0))
events.append(('G1H9', '2016-10-13T09:00:00', '2016-10-14T06:00:00', 6.3))
events.append(('G1H9', '2016-10-25T09:00:00', '2016-10-26T03:00:00', 6.3))
events.append(('G1H9', '2017-04-21T18:00:00', '2017-04-22T15:00:00', 5.7))
events.append(('G1H9', '2017-05-27T21:00:00', '2017-05-28T09:00:00', 7.0))
events.append(('G1H9', '2017-07-16T06:00:00', '2017-07-16T21:00:00', 6.0))
events.append(('G1H9', '2017-09-15T18:00:00', '2017-09-16T03:00:00', 5.3))
events.append(('G1H9', '2017-09-27T18:00:00', '2017-09-28T09:00:00', 6.7))
events.append(('G1H9', '2017-10-13T12:00:00', '2017-10-14T00:00:00', 5.7))
events.append(('G1H9', '2018-08-26T00:00:00', '2018-08-26T18:00:00', 7.3))
events.append(('G1H9', '2019-08-05T06:00:00', '2019-08-05T15:00:00', 5.3))
events.append(('G1H9', '2019-09-01T00:00:00', '2019-09-01T12:00:00', 5.3))
events.append(('G1H9', '2021-10-12T00:00:00', '2021-10-12T12:00:00', 6.3))
events.append(('G1H9', '2022-03-13T12:00:00', '2022-03-14T00:00:00', 6.3))
events.append(('G1H9', '2022-09-04T00:00:00', '2022-09-05T03:00:00', 6.3))
events.append(('G1H9', '2023-02-26T18:00:00', '2023-02-28T03:00:00', 6.7))
events.append(('G1H9', '2023-05-20T00:00:00', '2023-05-20T09:00:00', 5.7))
events.append(('G1H9', '2023-06-15T15:00:00', '2023-06-16T03:00:00', 6.0))
events.append(('G1H9', '2023-08-05T00:00:00', '2023-08-05T09:00:00', 6.3))
events.append(('G1H9', '2023-09-24T18:00:00', '2023-09-25T03:00:00', 5.7))
events.append(('G1H9', '2023-11-25T09:00:00', '2023-11-25T18:00:00', 6.3))
events.append(('G1H9', '2023-12-01T09:00:00', '2023-12-02T00:00:00', 6.7))
events.append(('G1H9', '2024-04-19T06:00:00', '2024-04-19T18:00:00', 7.0))
# events.append(('G1H9', '2024-10-07T09:00:00', '2024-10-08T06:00:00', 7.0))
# events.append(('G1H9', '2025-03-08T18:00:00', '2025-03-09T03:00:00', 5.7))
# events.append(('G1H9', '2025-03-21T18:00:00', '2025-03-22T03:00:00', 5.7))
# events.append(('G1H9', '2025-04-04T18:00:00', '2025-04-05T03:00:00', 5.7))
# events.append(('G1H9', '2025-04-15T15:00:00', '2025-04-16T00:00:00', 6.3))
# events.append(('G1H9', '2025-05-29T00:00:00', '2025-05-29T21:00:00', 6.3))
# events.append(('G1H9', '2025-06-02T00:00:00', '2025-06-03T15:00:00', 7.0))
# events.append(('G1H9', '2025-06-12T18:00:00', '2025-06-14T03:00:00', 6.7))

events = pd.DataFrame(events, columns=['prefix', 'start', 'end', 'max_kp'])

# sort by start
events = events.sort_values(by='start')

delta_minutes = 15

format = '%Y-%m-%dT%H:%M:%S'
events['date_start'] = pd.to_datetime(events['start'], format=format)
events['date_end'] = pd.to_datetime(events['end'], format=format)
events['duration'] = events['date_end'] - events['date_start']

# Round down date_start to nearest :00, :15, :30, :45
events['date_start'] = events['date_start'].dt.floor('15min')

# count the number of times each unique prefix appears
events['event_id'] = events.groupby('prefix').cumcount() + 1

EventCatalog = {}
for prefix in events['prefix'].unique():
    events_with_prefix = events[events['prefix'] == prefix]
    num_events = len(events_with_prefix)
    for i in range(num_events):
        event = events_with_prefix.iloc[i]
        # event_id = prefix + '-' + str(i+1).zfill(len(str(num_events)))
        date_start = event['date_start'].isoformat()
        date_end = event['date_end'].isoformat()
        duration = event['duration']
        # sequence_length is the duration in units of time step (15 minutes)
        time_steps = int(duration.total_seconds() / (15*60))
        event_id = prefix + '-' + event['date_start'].strftime("%Y%m%d%H%M")
        max_kp = event['max_kp']
        EventCatalog[event_id] = {
            'date_start': date_start,
            'date_end': date_end,
            'duration': duration,
            'max_kp': max_kp,
            'time_steps': time_steps
        }


# Print the event catalog in a readable format
if __name__ == "__main__":
    for event, val in EventCatalog.items():
        print(event, val['date_start'], val['date_end'], val['duration'], val['max_kp'], val['time_steps'])

# event_id          date_start          date_end            duration     max_kp time_steps
# G1H9-201004050600 2010-04-05T06:00:00 2010-04-05T15:00:00 0 days 09:00:00 7.7 36
# G1H9-201005021200 2010-05-02T12:00:00 2010-05-03T00:00:00 0 days 12:00:00 6.0 48
# G1H9-201109091200 2011-09-09T12:00:00 2011-09-10T03:00:00 0 days 15:00:00 5.7 60
# G1H9-201109261200 2011-09-26T12:00:00 2011-09-27T03:00:00 0 days 15:00:00 6.3 60
# G1H9-201203070300 2012-03-07T03:00:00 2012-03-07T18:00:00 0 days 15:00:00 6.0 60
# G1H9-201203151200 2012-03-15T12:00:00 2012-03-15T21:00:00 0 days 09:00:00 6.3 36
# G1H9-201204231800 2012-04-23T18:00:00 2012-04-24T06:00:00 0 days 12:00:00 6.7 48
# G1H9-201207150300 2012-07-15T03:00:00 2012-07-16T06:00:00 1 days 03:00:00 7.0 108
# G1H9-201210130300 2012-10-13T03:00:00 2012-10-13T15:00:00 0 days 12:00:00 5.7 48
# G1H9-201306010000 2013-06-01T00:00:00 2013-06-01T12:00:00 0 days 12:00:00 7.0 48
# G1H9-201306062100 2013-06-06T21:00:00 2013-06-07T06:00:00 0 days 09:00:00 5.7 36
# G1H9-201306282100 2013-06-28T21:00:00 2013-06-29T12:00:00 0 days 15:00:00 6.3 60
# G1H9-201310081800 2013-10-08T18:00:00 2013-10-09T06:00:00 0 days 12:00:00 5.7 48
# G1H9-201402190300 2014-02-19T03:00:00 2014-02-19T12:00:00 0 days 09:00:00 6.3 36
# G1H9-201402200300 2014-02-20T03:00:00 2014-02-20T12:00:00 0 days 09:00:00 6.0 36
# G1H9-201406080300 2014-06-08T03:00:00 2014-06-08T12:00:00 0 days 09:00:00 6.3 36
# G1H9-201503181200 2015-03-18T12:00:00 2015-03-18T21:00:00 0 days 09:00:00 5.3 36
# G1H9-201504161800 2015-04-16T18:00:00 2015-04-17T03:00:00 0 days 09:00:00 6.0 36
# G1H9-201505130000 2015-05-13T00:00:00 2015-05-13T09:00:00 0 days 09:00:00 5.7 36
# G1H9-201507041800 2015-07-04T18:00:00 2015-07-05T03:00:00 0 days 09:00:00 5.3 36
# G1H9-201508261500 2015-08-26T15:00:00 2015-08-27T06:00:00 0 days 15:00:00 6.3 60
# G1H9-201509071200 2015-09-07T12:00:00 2015-09-08T03:00:00 0 days 15:00:00 6.3 60
# G1H9-201509090300 2015-09-09T03:00:00 2015-09-09T21:00:00 0 days 18:00:00 6.0 72
# G1H9-201510070300 2015-10-07T03:00:00 2015-10-08T06:00:00 1 days 03:00:00 7.3 108
# G1H9-201511070000 2015-11-07T00:00:00 2015-11-07T09:00:00 0 days 09:00:00 6.0 36
# G1H9-201512311800 2015-12-31T18:00:00 2016-01-01T06:00:00 0 days 12:00:00 6.0 48
# G1H9-201602160900 2016-02-16T09:00:00 2016-02-17T00:00:00 0 days 15:00:00 5.3 60
# G1H9-201605080000 2016-05-08T00:00:00 2016-05-09T00:00:00 1 days 00:00:00 6.3 96
# G1H9-201606051200 2016-06-05T12:00:00 2016-06-05T21:00:00 0 days 09:00:00 5.3 36
# G1H9-201609011800 2016-09-01T18:00:00 2016-09-02T03:00:00 0 days 09:00:00 6.0 36
# G1H9-201610130900 2016-10-13T09:00:00 2016-10-14T06:00:00 0 days 21:00:00 6.3 84
# G1H9-201610250900 2016-10-25T09:00:00 2016-10-26T03:00:00 0 days 18:00:00 6.3 72
# G1H9-201704211800 2017-04-21T18:00:00 2017-04-22T15:00:00 0 days 21:00:00 5.7 84
# G1H9-201705272100 2017-05-27T21:00:00 2017-05-28T09:00:00 0 days 12:00:00 7.0 48
# G1H9-201707160600 2017-07-16T06:00:00 2017-07-16T21:00:00 0 days 15:00:00 6.0 60
# G1H9-201709151800 2017-09-15T18:00:00 2017-09-16T03:00:00 0 days 09:00:00 5.3 36
# G1H9-201709271800 2017-09-27T18:00:00 2017-09-28T09:00:00 0 days 15:00:00 6.7 60
# G1H9-201710131200 2017-10-13T12:00:00 2017-10-14T00:00:00 0 days 12:00:00 5.7 48
# G1H9-201808260000 2018-08-26T00:00:00 2018-08-26T18:00:00 0 days 18:00:00 7.3 72
# G1H9-201908050600 2019-08-05T06:00:00 2019-08-05T15:00:00 0 days 09:00:00 5.3 36
# G1H9-201909010000 2019-09-01T00:00:00 2019-09-01T12:00:00 0 days 12:00:00 5.3 48
# G1H9-202110120000 2021-10-12T00:00:00 2021-10-12T12:00:00 0 days 12:00:00 6.3 48
# G1H9-202203131200 2022-03-13T12:00:00 2022-03-14T00:00:00 0 days 12:00:00 6.3 48
# G1H9-202209040000 2022-09-04T00:00:00 2022-09-05T03:00:00 1 days 03:00:00 6.3 108
# G1H9-202302261800 2023-02-26T18:00:00 2023-02-28T03:00:00 1 days 09:00:00 6.7 132
# G1H9-202305200000 2023-05-20T00:00:00 2023-05-20T09:00:00 0 days 09:00:00 5.7 36
# G1H9-202306151500 2023-06-15T15:00:00 2023-06-16T03:00:00 0 days 12:00:00 6.0 48
# G1H9-202308050000 2023-08-05T00:00:00 2023-08-05T09:00:00 0 days 09:00:00 6.3 36
# G1H9-202309241800 2023-09-24T18:00:00 2023-09-25T03:00:00 0 days 09:00:00 5.7 36
# G1H9-202311250900 2023-11-25T09:00:00 2023-11-25T18:00:00 0 days 09:00:00 6.3 36
# G1H9-202312010900 2023-12-01T09:00:00 2023-12-02T00:00:00 0 days 15:00:00 6.7 60
# G1H9-202404190600 2024-04-19T06:00:00 2024-04-19T18:00:00 0 days 12:00:00 7.0 48
# G2H9-201108051800 2011-08-05T18:00:00 2011-08-06T03:00:00 0 days 09:00:00 7.7 36
# G2H9-201110241800 2011-10-24T18:00:00 2011-10-25T06:00:00 0 days 12:00:00 7.3 48
# G2H9-201203090000 2012-03-09T00:00:00 2012-03-09T15:00:00 0 days 15:00:00 8.0 60
# G2H9-201303170600 2013-03-17T06:00:00 2013-03-17T21:00:00 0 days 15:00:00 6.7 60
# G2H9-201506221200 2015-06-22T12:00:00 2015-06-23T12:00:00 1 days 00:00:00 8.3 96
# G2H9-201509110600 2015-09-11T06:00:00 2015-09-11T15:00:00 0 days 09:00:00 7.0 36
# G2H9-201709072100 2017-09-07T21:00:00 2017-09-08T21:00:00 1 days 00:00:00 8.3 96
# G2H9-201711071800 2017-11-07T18:00:00 2017-11-08T03:00:00 0 days 09:00:00 6.3 36
# G2H9-202111032100 2021-11-03T21:00:00 2021-11-04T12:00:00 0 days 15:00:00 7.7 60
# G2H9-202303230900 2023-03-23T09:00:00 2023-03-24T06:00:00 0 days 21:00:00 8.0 84
# G2H9-202304231200 2023-04-23T12:00:00 2023-04-24T09:00:00 0 days 21:00:00 8.3 84
# G2H9-202311050900 2023-11-05T09:00:00 2023-11-05T21:00:00 0 days 12:00:00 7.3 48
# G2H9-202405101500 2024-05-10T15:00:00 2024-05-12T03:00:00 1 days 12:00:00 9.0 144
# G2H9-202406280900 2024-06-28T09:00:00 2024-06-28T18:00:00 0 days 09:00:00 7.7 36
