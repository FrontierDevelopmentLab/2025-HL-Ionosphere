NASA Heliolab 2025 - Ionosphere-Thermosphere Twin, ML experiments
Log file: ./train-4/log.txt
Arguments:
--data_dir /mnt/ionosphere-data/ --mode train --target_dir ./train-4 --num_workers 6 --batch_size 2 --device cuda --epochs 1
Config:
{'batch_size': 2,
 'data_dir': '/mnt/ionosphere-data/',
 'date_end': '2024-08-01T00:00:00',
 'date_start': '2010-05-13T00:00:00',
 'device': 'cuda',
 'epochs': 1,
 'jpld_dir': 'jpld/webdataset',
 'learning_rate': 0.0003,
 'mode': 'train',
 'model_type': 'VAE1',
 'num_evals': 4,
 'num_workers': 6,
 'seed': 0,
 'target_dir': './train-4',
 'valid_proportion': 0.15,
 'weight_decay': 0}
Start time: 2025-07-22 22:24:17.912792
Training mode selected.
Warning: Batch size 2 is less than num_evals 4. Using the batch size for num_evals.

JPLD
Directory  : /mnt/ionosphere-data/jpld/webdataset
Loading tar files index from cache: /mnt/ionosphere-data/jpld/webdataset/tar_files_index
End date out of range, using default
Start date : 2010-05-13 00:00:00
End date   : 2024-07-31 23:45:00
Delta      : 15 minutes
Loading dates from cache: /mnt/ionosphere-data/jpld/webdataset/dates_index_2010-05-13T00:00:00_2024-07-31T23:45:00
TEC maps total    : 498,623
TEC maps available: 498,481
TEC maps dropped  : 142

Train size: 423,709
Valid size: 74,772
Creating new model

Number of parameters: 13,622,755


*** Epoch 1/1 started
*** Training
Traceback (most recent call last):
  File "/home/hert7450/2025-HL-Ionosphere/scripts/ml/run.py", line 271, in main
    loss = model.loss(jpld)
  File "/home/hert7450/2025-HL-Ionosphere/scripts/ml/models.py", line 73, in loss
    x_recon, mu, logvar = self.forward(x)
                          ~~~~~~~~~~~~^^^
  File "/home/hert7450/2025-HL-Ionosphere/scripts/ml/models.py", line 52, in forward
    mu, logvar = self.encode(x)
                 ~~~~~~~~~~~^^^
  File "/home/hert7450/2025-HL-Ionosphere/scripts/ml/models.py", line 42, in encode
    h = self.encoder(x)
  File "/home/hert7450/.conda/envs/ioncast_halil/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/hert7450/.conda/envs/ioncast_halil/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hert7450/.conda/envs/ioncast_halil/lib/python3.13/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
  File "/home/hert7450/.conda/envs/ioncast_halil/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/hert7450/.conda/envs/ioncast_halil/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hert7450/.conda/envs/ioncast_halil/lib/python3.13/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hert7450/.conda/envs/ioncast_halil/lib/python3.13/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ~~~~~~~~^
        input, weight, bias, self.stride, self.padding, self.dilation, self.groups
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
KeyboardInterrupt
